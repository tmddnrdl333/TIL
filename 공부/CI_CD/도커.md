# 도커

## 도커란

- 도커는 컨테이너 기술을 기반으로 한 일종의 가상화 플랫폼.
  가상화란 물리적 자원인 하드웨어를 효율적으로 활용하기 위해, 하드웨어 공간 위에 가상의 머신을 만드는 기술이고,
  컨테이너란 컨테이너가 실행되고 있는 호스트 os의 기능을 그대로 사용하면서 프로세스를 격리해 독립된 환경을 만드는 기술을 뜻한다.

- 다시 말해, 도커는 **독립된 환경을 만들어서 하드웨어를 효율적으로 활용하는 기술**이라고 할 수 있다.

## 가상화와 컨테이너

- 가상화는 하나의 하드웨어를 여러 가상 머신으로 분할해 효율적으로 활용할 수 있는 기술인데, 분할된 가상머신들은 각각 독립적인 환경으로 구동된다. 이 때 베이스가 되는 기존 환경을 Host OS, 그리고 가상 머신으로 분할된 각각 환경을 Guest OS라고 부른다.

- 가상 머신을 생성하기 위해서는 하이퍼바이저 또는 가상 머신 모니터라고 불리는 소프트웨어를 이용한다. 하이퍼바이저는 호스트 하드웨어에 설치되어 호스트와 게스트를 나누는 역할을 하고, 각각 게스트는 하이퍼바지어에 의해 관리되며 시스템 자원을 할당받는다. 이 때 하이퍼바이저에 의해 생성된 게스트는 호스트나 다른 게스트와 상호 간섭하지 않고, 완전히 분리된 환경에서 구동된다. 하이퍼바이저를 활용하면 마치 하드웨어가 여러 개인 것처럼 하나의 서버를 여러 명이 나눠 쓸 수도 있고, 컴퓨터 한 대에서 서로 다른 OS를 동시에 사용할 수도 있다.

- 하지만 가상 머신으로 작업을 하려면 반드시 하이퍼바이저를 거쳐야 하기 때문에, 속도 저하는 필연적이다. 또 가상 머신은 해당 환경을 구동하는 데 필요한 파일을 모두 포함하고 있기 때문에, 가상 머신을 배포할 때 만들어지는 이미지의 크기가 매우 커진다는 한계점이 있다.

- 하이퍼바이저와 달리 컨테이너는 가상의 OS를 만드는 것은 아니다. 컨테이너는 베이스 환경의 OS를 공유하면서 필요한 프로세스만 격리하는 방식으로, 커널을 공유하기 때문에 호스트 OS의 기능을 모두 사용할 수 있다. 그렇기 때문에 컨테이너 위에서는 호스트 OS와 다른 OS를 구동할 수는 없다. 대신 격리시킬 애플리케이션과 거기에 필요한 파일이나 특정 라이브러리 등 종속 항목만 포함하기 때문에 상대적으로 배포를 위해 생성되는 이미지 용량이 작아진다는 장점이 있다. 운영체제가 아닌 프로세스이며, 하이퍼바이저를 거칠 필요가 없어 실행 속도도 빠르다.

> 이미지는 가상 머신이나 컨테이너 또는 프로그램을 실행하는 데 필요한 파일과 라이브러리, 설정 등을 가지고 있는 파일이다. 이미지는 레이어라는 계층 구조로 이루어져 있는데, 변경 사항이 생기면 새로운 레이어를 추가해서 기록한다. 이미지 전체를 새로 받지 않고 해당 레이어만 받는 것으로 이미지를 업데이트할 수 있다는 장점이 있다.
> 
> 이미지를 실행하면 프로세스, 즉 컨테이너가 된다.

## 그래서 도커란?

- 가상화와 컨테이너가 무엇인지 알았으니 도커로 돌아가자면...

- 도커는 컨테이너 기반 가상화 플랫폼이다. 부두에서 컨테이너를 옮기고 관리하는 직업인 docker에서 따 온 이름에 맞게, 컨테이너를 잘 다룰 수 있게 도와주는 도구라고 할 수 있다. 도커를 이용하면 이미지를 실행시켜 컨테이너로 만들거나, 생성된 컨테이너를 관리하거나, 컨테이너를 다시 이미지로 만드는 작업을 쉽게 할 수 있다.

- 도커는 아주 강력한 도구다. 개발 과정에서 다른 라이브러리와 충돌하는 것을 방지하기 위해 격리된 환경이 필요할 때, 완성된 서비스를 배포할 때, 혹은 배포 중인 서비스를 받아서 실행해 볼 때에도 유용하다. 특히 배포 과정에서 도커를 사용해 필요한 파일들만 예쁘게 포장해서 이미지로 만들면, 지긋지긋한 종속성 이슈에서 벗어날 수 있게 된다. 서버 한 대에만 배포한다면 종속성은 큰 문제가 아니지만, 서버가 많아진다면, 그냥 도커를 사용해서 같은 이미지를 실행해서 컨테이너로 만들면 된다.

[[ Docker #01 알아보기 1/5 ] - 도커란 무엇인가? — DataArtist](https://artistdata.tistory.com/3?category=1182143)

---

## 도커 엔진이란?

- Docker Engine은 클라이언트와 서버 아키텍처를 따르는 애플리케이션이고, 호스트 시스템에 설치되어 기본적으로 3가지 구성요소를 가지고 있다.
  - Server: Dockered라는 Docker daemon을 통해 도커 이미지를 만들고 관리할 수 있다.
  - REST API: Docker 데몬에게 무엇을 할지 지시하는 용도로 사용된다.
  - CLI: 도커 명령어를 입력하는데 사용되는 클라이언트이다.

## 도커 객체란?

- Docker로 작업할 때는 이미지, 컨테이너, 볼륨, 네트워크를 사용한다. 이것들을 모두 Docker 객체라고 표현한다.

## 도커 이미지란?

- **필요한 프로그램과 라이브러리, 소스를 설치한 뒤 만든 하나의 파일.**

- 이미지는 컨테이너를 만드는 설명이 포함된 읽기 전용 템플릿으로, 상태값을 가지지 않고 변하는 특성이 있다.

- Docker images는 Docker Hub에서 가져와서 사용하거나, 컨테이너로 실행시켜 추가되거나 변하는 값을 다시 이미지로 만들 수 있다.
  또한 Dockerfile을 사용하여 고유한 Docker 이미지를 만들 수도 있다.
  컨테이너를 실행시키기 위한 모든 사항들을 Dockerfile에 작성하면 된다.
  정리하자면, 컨테이너 실행에 필요한 모든 파일과 설정값을 가진 읽기 전용 템플릿이다.

- 이미지는 지속적으로 수정사항들을 업데이트할 수 있으며, 컨테이너 -> 이미지 -> 컨테이너 -> 이미지 를 반복하는 경우 용량은 200MB에서 20GB 이상도 가능해진다.

- 이러한 과정에서 Docker는 레이어(Layer)라는 개념을 사용한다.
  기존 이미지 레이어 위에 read-write 레이어를 추가하는 방식으로 유니온 파일 시스템을 이용하여 여러개의 레이어를 하나의 파일 시스템으로 사용할 수 있도록 한다.
  
  - 유니온 파일 시스템: 읽기 전용의 파일을 수정할 때 쓰기가 가능한 파일을 임시로 생성하고, 수정이 끝나는 경우 기존의 읽기 파일로 대체되는 방식의 파일 시스템이다.

- 파일이 수정될 때마다 원본 이미지에 대한 수정 값만을 관리한다. 즉, 새로운 버전 전체를 설치할 필요 없이, 추가된 새로운 레이어만 다운 받으면 된다.

## 도커 컨테이너란?

- **이미지를 기반으로 독립된 공간에서 실행한 가상환경**

- 일반적으로 배에 물품을 유통하는 컨테이너와 유사하게, 각 컨테이너에는 다양한 종류가 들어갈 수 있으나, 철저하게 규격화되어 있으며 쉽게 옮겨 실을 수 있다.

- 크게는 시스템 컨테이너와 애플리케이션 컨테이너 총 2가지로 나누어진다.
  시스템 컨테이너는 운영체제 위에 하드웨어 가상화 없이 운영체제를 실행시킨다. 어플리케이션 컨테이너는 MariaDB, Python 등 필요한 프로그램만 Docker로 별도 실행시킬 수 있다.

- 컨테이너는 특히 오버헤드가 적기 때문에 가볍고 고속으로 작동하는 것이 특징이다. 다수의 컨테이너를 OS커널에서 직접 구동하므로 훨씬 가볍게 운영체제 커널을 공유하며 운영체제 전체 부팅보다 메모리를 적게 사용합니다.

- 도커 이미지를 실행하면 컨테이너가 생성됩니다. 모든 애플리케이션 및 환경은 해당 컨테이너에서 실행됩니다. CLI 또는 Docker API 등을 통해 컨테이너를 실행, 중지, 삭제할 수 있습니다.









[[ Docker #02 알아보기 2/5 ] -Docker Engine과 용어 이해 — DataArtist](https://artistdata.tistory.com/4?category=1182143)


